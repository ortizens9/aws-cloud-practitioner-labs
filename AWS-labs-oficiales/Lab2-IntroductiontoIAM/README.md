# [Introduction to AWS Identity and Access Management (IAM)](/AWS-labs-oficiales/Lab2-IntroductiontoIAM/Capturas/00.png)

Antes de ponerme a explicar el lab, voy a explicar de forma corta en qué consiste IAM. Es un servicio que nos ayuda a controlar quién y a qué accede en la nube de AWS. Es el que asigna quien entra y qué puede tocar o ver(Permisos para usuarios, roles o servicios).
Podemos tener usuarios individuales dentro, que no formen parte de ningún grupo como un administrador.
Organizar los usuarios en grupos, para darles permisos conjuntamente. Darle permisos a roles o definir estos permisos escritos en JSON.

## Pues vamos allá. Este lab está dividido en 3 tareas.
## ·La primera dice: Exploración de usuarios y grupos.
Una vez iniciado el Lab. Nos hace entrar en la pestaña de [Personas](/AWS-labs-oficiales/Lab2-IntroductiontoIAM/Capturas/1.png). Ahí vemos **3 usuarios**. Si hacemos clic al user-1 en la pestaña permisos vemos que user-1 [no tiene permisos](/AWS-labs-oficiales/Lab2-IntroductiontoIAM/Capturas/2.png). Si vamos a la pestaña “Credenciales de seguridad”, user-1 tiene asignada una [contraseña de consola](/AWS-labs-oficiales/Lab2-IntroductiontoIAM/Capturas/3.png).
Si vamos a **Grupos de personas**, vemos que están creados 3 grupos: _EC2-Admin_, _EC2-Support_ y _S3-Support_.
Si hacemos clic a _EC2-Support_ y vamos a la pestaña permisos, vemos que tiene [una política](/AWS-labs-oficiales/Lab2-IntroductiontoIAM/Capturas/4.png) llamada _AmazonEC2ReadOnlyAccess_. Esta política muestra y describe la información de EC2, ELB, Cloudwatch y ASG. **No permite modificar**, únicamente ver. Nos anima a que miremos la política en [su forma JSON](/AWS-labs-oficiales/Lab2-IntroductiontoIAM/Capturas/5.png).
Como ya he dicho antes, las políticas de permisos están escritas en JSON. Que en su estructura tienen Efecto, Acción y Recurso.(Effect, Allow, Resource).
Volvemos a **Grupos de personas** y seleccionamos _S3-Support_. Este [tiene una política](/AWS-labs-oficiales/Lab2-IntroductiontoIAM/Capturas/6.png) _AmazonS3ReadOnlyAccess_. Vayamonos acordando de los permisos de cada grupo porque luego nos encontraremos con ello. Esta política nos muestra los recursos de Amazon S3.
Y finalmente miramos los permisos de _EC2-Admin_ y este grupo tiene una política en línea o según veo una [política de cliente insertado](/AWS-labs-oficiales/Lab2-IntroductiontoIAM/Capturas/8.png) que se hace llamar “_EC2-Admin-Policy_”. Esta, [según nos muestra](/AWS-labs-oficiales/Lab2-IntroductiontoIAM/Capturas/9.png) **nos da permiso para parar y empezar instancias EC2**.
Para que lo recordemos nos vuelve a repetir qué hace cada grupo y además en qué grupo deberían ir cada uno de los 3 usuarios. Nos dice que el user-1 debe ir a [_S3-Support_](/AWS-labs-oficiales/Lab2-IntroductiontoIAM/Capturas/10.png)(Acceso sólo lectura S3), el user-2 a _EC2-Support_(Acceso sólo lectura EC2) y el user-3 a _EC2-Admin_(Parar/Iniciar/Ver instancias EC2).
## ·La segunda tarea nos hace colocar [como hemos dicho antes](/AWS-labs-oficiales/Lab2-IntroductiontoIAM/Capturas/11.png), los usuarios en los grupos.
** ·La tercera tarea** nos hace abrir en un una pestaña privada en mi caso Safari. Y **pegamos la URL** que se denomina: [URL de inicio de sesión para los usuarios IAM de esta cuenta](/AWS-labs-oficiales/Lab2-IntroductiontoIAM/Capturas/12.png). Copiamos [este enlace](/AWS-labs-oficiales/Lab2-IntroductiontoIAM/Capturas/13.png) y lo pegamos en esa pestaña creada.
Luego en la parte izquierda de las indicaciones del Lab [**nos dice varias cosas**](/AWS-labs-oficiales/Lab2-IntroductiontoIAM/Capturas/14.png): la contraseña de administrador(que nos valdrá para los 3 usuarios), la Región en que vamos a trabajar en el caso de tener que buscar las instancias ya que sinó no sabríamos donde se encuentran, el nombre de un Bucket que luego tendremos que buscar.


·Paso número 1 entramos con el user-1 y la contraseña que nos han dado. [Vamos a S3](/AWS-labs-oficiales/Lab2-IntroductiontoIAM/Capturas/15.png) y como este usuario tiene permisos **pues podemos ver todos los buckets** incluso podemos entrar a ver los objetos dentro de estos. En cambio, también nos pide que vayamos a EC2 a la región indicada: ap-northeast-1 y nos aparece [un mensaje](/AWS-labs-oficiales/Lab2-IntroductiontoIAM/Capturas/17.png) que **no nos autoriza ninguna operación con este servicio**. Salimos del usuario y copiamos y pegamos otra vez el enlace al inicio de sesión para los usuarios IAM.

·Paso número 2: Nos registramos con user-2 de la misma manera que habíamos hecho con user-1. Si no estamos en la región _ap-northeast-1_ que puede pasar que nuestro usuario al iniciar esté en otra región por lo que sea. **Hacemos clic en la flecha desplegable** y [lo cambiamos](/AWS-labs-oficiales/Lab2-IntroductiontoIAM/Capturas/16.png) a esta. [Abrimos EC2](/AWS-labs-oficiales/Lab2-IntroductiontoIAM/Capturas/18.png). Con este usuario **debemos ver las instancias que existen en esta región**, aunque si queremos cambiar el estado de esta, haciendo [clic en detener instancia](/AWS-labs-oficiales/Lab2-IntroductiontoIAM/Capturas/19.png). **No nos lo permitirá**. Y si vamos [al servicio S3](/AWS-labs-oficiales/Lab2-IntroductiontoIAM/Capturas/20.png), **también tendremos denegado el acceso**. Salimos y volvemos a pegar el enlace de inicio de sesión.

·Tercer paso: Accedemos con el user-3>[Vamos al servicio EC2](/AWS-labs-oficiales/Lab2-IntroductiontoIAM/Capturas/21.png)>Instancias(Recordamos que en el caso de no estar en la región adecuada no encontraremos la instancia)>La seleccionamos y le damos a detener. [**Ahora sí que nos lo permite**](/AWS-labs-oficiales/Lab2-IntroductiontoIAM/Capturas/22.png).

**Una vez esto**, ya habremos acabado la parte práctica. Luego tendremos un cuestionario de esta manera podemos ver nuestros puntos flojos, por ejemplo, yo no estaba familiarizado con la expresión: _Identify Federation_(Acceso federado), que permite que usuarios sin autentificarse en AWS pueden autenticarse con una cuenta creada en otro sistema de identidad externo, como _Microsoft Active Directory, Google Workspace, a través de redes sociales, Auth0_… Recordemos que la mejor manera de actuar en IAM es <ins>con la regla del mínimo privilegio</ins>, que significa que cada usuario tiene que tener los permisos justos y necesarios para funcionar bien, ni uno más, ni uno menos. Lo hacemos y en el caso de haber entendido un 80% lo aprobaremos. Enviamos los resultados y acabamos el lab.
